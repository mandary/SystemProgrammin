This is the goal for our C implementations -- to achieve the
same functionality as this Java code and, to the extent possible,
for the code to feel like this Java code.
